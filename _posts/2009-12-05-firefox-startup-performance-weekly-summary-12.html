---
layout: post
title: Firefox Startup Performance Weekly Summary
date: 2009-12-05 08:00:08.000000000 -08:00
categories:
- firefox
- mozilla
tags:
- firefox
- mozilla
- Performance
- startup
status: publish
type: post
published: true
meta:
  _edit_last: '267418'
author:
  login: autonome
  email: autonome@gmail.com
  display_name: Dietrich Ayala
  first_name: ''
  last_name: ''
---
<p>Current numbers are available on the <a href="http://graphs.mozilla.org/dashboard/snapshot/">Performance  Snapshot</a> page for all tests.</p>
<p>Summary current startup performance, relative to Firefox 3.5:</p>
<ul>
<li>Warm startup: For Mac, 34% better on 3.6 and 32% better on 3.7. Flat on Windows for 3.6, and since Windows 3.6 was ~5% improved over 3.5 last post, so there appears to be a regression here. However, the graph data is not showing a 5% regression, so something might be incorrect in the snapshot code.</li>
<li>Cold startup:  For Mac, I'm discarding past numbers since we were not measuring it correctly (<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=532965">bug 532965</a>). For  Windows, still not measuring yet. For Linux, the ~9% regression discrepancy from the last post is now gone,  putting 3.6 at 3% improved over 3.5 and trunk at a 3% regression. However, there are regular multi-run spikes in the graph, so I'm not sure we're getting the best data out of this measurement scheme either.</li>
</ul>
<p>This week's activity:</p>
<ul>
<li>Rob Strong landed <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=532552">bug 532552</a>, which removes the blocklist service from the startup path. This <a href="http://exchangecode.com/robert/work/ce_logs/log.txt">log of WinCE startup</a>, generated from <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=470116">Taras' patch here</a>, made it apparent that the service was in the startup path and taking a significant amount of time. Poke around that log, there's more goods to be had.</li>
<li>Taras landed a bunch of JAR related bugs on branch: <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=510844">bug 510844</a>, <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=511754">bug 511754</a>, <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=525755">bug 525755</a>, <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=523065">bug 523065</a>, <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=521227">bug 521227</a>.</li>
<li>Rob Strong put up a <a title="http://blog.mozilla.com/rstrong/2009/11/29/the-fastest-code-is-the-code-that-never-runs/" rel="nofollow" href="http://blog.mozilla.com/rstrong/2009/11/29/the-fastest-code-is-the-code-that-never-runs/">detailed  post</a> about his startup improvements to the  update service, the  effect on mobile, and pointed out some other  front-end services that  could benefit from the same treatment.</li>
<li>Joel's static Firefox is working (<a title="https://bugzilla.mozilla.org/show_bug.cgi?id=525013" rel="nofollow" href="https://bugzilla.mozilla.org/show_bug.cgi?id=525013">bug 525013</a>), and is showing ~10% improvement in  startup time on Mac. He's moved on to improving code locality (<a title="https://bugzilla.mozilla.org/show_bug.cgi?id=531406" rel="nofollow" href="https://bugzilla.mozilla.org/show_bug.cgi?id=531406">bug 531406</a>). However, time-ordering of symbols  doesn't seem to improve the sequentiality of the page-ins by much, so  maybe more improvements there. More data on the bug.</li>
<li> Ben is making progress on the fastload replacement in <a title="https://bugzilla.mozilla.org/show_bug.cgi?id=520309" rel="nofollow" href="https://bugzilla.mozilla.org/show_bug.cgi?id=520309">bug 520309</a>.</li>
<li>No updates on Windows cold-startup testing for  Talos on <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=522807">bug  522807</a>. I need to test on Vista, and turn off Pre/Superfetch.</li>
<li>Taras has a new patch up for service caching (<a title="https://bugzilla.mozilla.org/show_bug.cgi?id=516085" rel="nofollow" href="https://bugzilla.mozilla.org/show_bug.cgi?id=516085">bug 516085</a>).</li>
<li>Rebasing on Windows in <a title="https://bugzilla.mozilla.org/show_bug.cgi?id=484799" rel="nofollow" href="https://bugzilla.mozilla.org/show_bug.cgi?id=484799">bug 484799</a> messed up mobile builds, was backed out.</li>
<li>Jonathan Kew's patch on <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=519445">bug        519445</a> for further reductions in Mac startup       time spent in  font system initialization, is ready to land when the tree re-opens.</li>
</ul>
<p>Projects in a holding pattern:</p>
<ul>
<li>Super-fast-path-ing of Components.* (<a title="https://bugzilla.mozilla.org/show_bug.cgi?id=512584" rel="nofollow" href="https://bugzilla.mozilla.org/show_bug.cgi?id=512584">bug  512584</a>) is on hold, blocking on getting help from JS team or  someone else who knows that code.</li>
<li>Ryan Flint has a WIP patch to minify JS on <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=524858">bug  524858</a> that significantly reduces the size of shipped JavaScript  files.</li>
<li>JARification: David abandoned <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=509755">moving JS          modules into a JAR file</a>, since those files are fastloaded.         However, since we want things like post-extension-install  restarts  to   be     fast, and those cause fastload cache invalidation,  we might   want  to   do   things like this anyways. I filed a bug for  the same   treatment  for     components. These are lower priority,  since they're   not the  normal     startup case. Follow along with all  JAR-ification   via<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=513027"> the         tracker  bug</a>.</li>
<li>Startup Timeline: No updates, still not landed. Add [ft] in the        whiteboard of your bug w/ the function names you want timed and David        will generate it and update the bug.</li>
<li>Static Analysis: No progress on <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=506128">bug        506128</a>.  David needs to file a bug with the final log of        named-yet-uncalled  functions.</li>
<li>Dirty Profile Testing: No progress. Need to list scenarios, file        bugs  for each, generate Talos config patches and profile data, and    then     move  it into Rel-Eng territory. Also, need to get a separate       Tinderbox  tree,  since it’s going to cause a bazillion new  columns.</li>
<li><a href="http://wagerlabs.com/">Joel        Reymont</a> noted in<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=513076"> bug        513076</a> that there are serious drawbacks to getting our libraries  in       the dyld  shared cache on Mac, so has deprioritized that work.</li>
<li>No updates on Zack's CSS parser changes in <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=513149">bug          513149</a>.</li>
</ul>
<p>As usual, more details and links are  available on <a href="https://wiki.mozilla.org/Firefox/Projects/Startup_Time_Improvements">the       project wiki</a>, and we're available to answer questions in <a href="irc://irc.mozilla.org/#startup">#startup on irc.mozilla.org</a>.</p>
